package com.tjoeun.networkTest2;

import java.io.IOException;
import java.io.PrintWriter;
import java.net.ServerSocket;
import java.net.Socket;
import java.util.Scanner;

public class Server3 {

   public static void main(String[] args) {
      
	   ServerSocket server = null;
	   Socket socket = null;
	   PrintWriter printWriter = null;
	   Scanner scanner = null;
	   Scanner scan = null;
	   
	   try {
		server = new ServerSocket(10004);
		System.out.println("서버 시작: " + server);
		System.out.println("클라이언트 접속 기다리는 중");
		socket = server.accept();
		
		printWriter = new PrintWriter(socket.getOutputStream());
		scanner = new Scanner(socket.getInputStream());
		scan = new Scanner(System.in);
		
		printWriter.write("안녕 클라이언트\n");
		printWriter.flush();
		
		String msg = "";
		do {
//			클라이언트에서 전송받은 메시지를 출력한다.
			msg = scanner.nextLine();
			System.out.print("client >> " + msg);
			if(msg.toUpperCase().equals("BYE")) {
				break;
			}
//			클라이언트로 보낼 메시지를 출력한다.
			System.out.print("server >> " );
			msg = scan.nextLine().trim();
			printWriter.write(msg + "\n");
			printWriter.flush();
		} while(msg.toUpperCase().equals("BYE"));
		
	} catch (IOException e) {
		e.printStackTrace();
	} finally {
		if(socket != null) {try {socket.close();} catch (IOException e) {e.printStackTrace();}}
		if(server != null) {try {socket.close();} catch (IOException e) {e.printStackTrace();}}
	}
	   
	   
   }
      
}
      

   
